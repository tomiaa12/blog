# æ³¨è§£

æ³¨è§£ï¼ˆAnnotationï¼‰å¯ä»¥ç†è§£ä¸ºï¼š**å†™åœ¨ä»£ç ä¸Šçš„â€œç»“æ„åŒ–æ ‡è®°â€**ã€‚å®ƒä¸åƒæ™®é€šæ³¨é‡Šåªç»™äººçœ‹ï¼Œæ³¨è§£æ˜¯ç»™ **ç¼–è¯‘å™¨ / å·¥å…· / æ¡†æ¶**çœ‹çš„å…ƒæ•°æ®ã€‚

å¦‚æœä½ æ˜¯å‰ç«¯ï¼Œå¯ä»¥æŠŠå®ƒç±»æ¯”æˆï¼š

- TS é‡Œçš„ **è£…é¥°å™¨ï¼ˆdecoratorï¼‰**ï¼š`@Component / @Injectable / @Controller ...`
- æˆ–è€…â€œç»™ä»£ç è´´æ ‡ç­¾â€ï¼Œè®©æ¡†æ¶åœ¨å¯åŠ¨æ—¶å»æ‰«æè¿™äº›æ ‡ç­¾ï¼Œç„¶ååšæ³¨å†Œã€æ ¡éªŒã€ç”Ÿæˆä»£ç ç­‰å·¥ä½œ

## æ³¨è§£èƒ½å¹²ä»€ä¹ˆ

æŒ‰â€œå‘ç”Ÿåœ¨ä»€ä¹ˆæ—¶å€™â€æ¥åˆ†æ›´å¥½è®°ï¼š

- **ç¼–è¯‘æœŸ**ï¼šç»™ç¼–è¯‘å™¨/IDE æç¤ºï¼ˆä¾‹å¦‚ `@Override`ï¼‰ã€åšé™æ€æ£€æŸ¥ï¼ˆä¾‹å¦‚ `@SuppressWarnings`ï¼‰
- **è¿è¡ŒæœŸ**ï¼šæ¡†æ¶é€šè¿‡ **åå°„**è¯»å–æ³¨è§£ï¼Œç„¶ååšâ€œè‡ªåŠ¨è£…é…/è·¯ç”±æ³¨å†Œ/å‚æ•°æ ¡éªŒ/é‰´æƒâ€ç­‰ï¼ˆå‰ææ˜¯ `@Retention(RUNTIME)`ï¼‰

## å¸¸ç”¨çš„é¢„å®šä¹‰æ³¨è§£ï¼ˆJDK è‡ªå¸¦ï¼‰

### `@Override`

è¡¨ç¤ºâ€œæˆ‘è¿™ä¸ªæ–¹æ³•æ˜¯é‡å†™çˆ¶ç±»/æ¥å£çš„æ–¹æ³•â€ã€‚å¥½å¤„æ˜¯ï¼š**å†™é”™æ–¹æ³•ç­¾åä¼šç›´æ¥ç¼–è¯‘å¤±è´¥**ï¼Œé¿å…ä½ ä»¥ä¸ºé‡å†™æˆåŠŸäº†ï¼Œå®é™…æ²¡æœ‰ç”Ÿæ•ˆã€‚

```java
package com.tomiaa;

/**
 * ç¤ºä¾‹ä»£ç ï¼ˆkuangyx.cnï¼‰
 *
 * @author : tomiaa
 * @website : https://kuangyx.cn
 * @project : kuangyx
 * @package : com.tomiaa
 * @className : OverrideTest
 */
public class OverrideTest {
    private Integer id;
    private String name;

    public OverrideTest(Integer id, String name) {
        this.id = id;
        this.name = name;
    }

    @Override
    public String toString() {
        return "OverrideTest{id=" + id + ", name='" + name + "'}";
    }

    public static void main(String[] args) {
        OverrideTest demo = new OverrideTest(101, "tomiaa");
        System.out.println(demo);
    }
}
```

### `@Deprecated`

è¡¨ç¤ºâ€œè¿™ä¸ªç±»/æ–¹æ³•/å­—æ®µå·²ç»è¿‡æ—¶ï¼Œä¸å»ºè®®å†ç”¨â€ã€‚ä¸€èˆ¬é…åˆ Javadoc è¯´æ˜æ›¿ä»£æ–¹æ¡ˆï¼š

```java
package com.tomiaa;

/**
 * ç¤ºä¾‹ä»£ç ï¼ˆkuangyx.cnï¼‰
 *
 * @author : tomiaa
 * @website : https://kuangyx.cn
 * @project : kuangyx
 * @package : com.tomiaa
 * @className : DeprecatedTest
 */
public class DeprecatedTest {
    /**
     * @deprecated å·²åºŸå¼ƒï¼Œè¯·ä½¿ç”¨ newSayHello()
     */
    @Deprecated
    public static void sayHello() {
        System.out.println("Hello World!");
    }

    public static void newSayHello() {
        System.out.println("Hello, Welcome to kuangyx.cn!");
    }

    public static void main(String[] args) {
        // IDE ä¸€èˆ¬ä¼šå¯¹ sayHello() æ ‡é»„æç¤º
        sayHello();
        newSayHello();
    }
}
```

### `@SuppressWarnings`

è¡¨ç¤ºâ€œæˆ‘çŸ¥é“è¿™é‡Œä¼šæœ‰æŸç§è­¦å‘Šï¼Œä½†æˆ‘ç¡®è®¤å®ƒæ˜¯å®‰å…¨çš„/å¯æ¥å—çš„ï¼Œè¯·ä¸è¦æç¤ºæˆ‘â€ã€‚

å¸¸è§å€¼ï¼š

| å€¼            | å«ä¹‰ï¼ˆä½ å¤§æ¦‚åœ¨å“ªä¼šé‡åˆ°ï¼‰                           |
| ------------- | -------------------------------------------------- |
| `deprecation` | è°ƒç”¨äº† `@Deprecated` çš„ API                        |
| `unchecked`   | æ³›å‹æ“¦é™¤å¯¼è‡´çš„æœªç»æ£€æŸ¥è½¬æ¢ï¼ˆå¸¸è§äºé›†åˆ + å¼ºè½¬ï¼‰     |
| `rawtypes`    | ä½¿ç”¨äº†åŸç”Ÿç±»å‹ï¼ˆä¾‹å¦‚ `List` è€Œä¸æ˜¯ `List<String>`ï¼‰|
| `unused`      | å®šä¹‰äº†å˜é‡/æ–¹æ³•ä½†æœªä½¿ç”¨                            |
| `all`         | å…³é—­ä»¥ä¸Šæ‰€æœ‰è­¦å‘Šï¼ˆä¸æ¨èï¼ŒèŒƒå›´å¤ªå¤§ï¼‰               |

```java
package com.tomiaa;

import java.util.ArrayList;
import java.util.List;

/**
 * ç¤ºä¾‹ä»£ç ï¼ˆkuangyx.cnï¼‰
 *
 * @author : tomiaa
 * @website : https://kuangyx.cn
 * @project : kuangyx
 * @package : com.tomiaa
 * @className : SuppressWarningsTest
 */
public class SuppressWarningsTest {
    @SuppressWarnings({"rawtypes", "unchecked"})
    public static void main(String[] args) {
        // rawtypes: æ²¡å†™æ³›å‹å‚æ•°
        List list = new ArrayList();
        // unchecked: å¾€ raw list é‡Œå¡ String
        list.add("kuangyx.cn");
        System.out.println(list);
    }
}
```

## è‡ªå®šä¹‰æ³¨è§£ï¼ˆä½ ä¹Ÿå¯ä»¥å†™è‡ªå·±çš„â€œæ ‡ç­¾â€ï¼‰

### 1ï¼‰æ€ä¹ˆå®šä¹‰

ç”¨ `@interface`ï¼š interface æ˜¯å…³é”®å­—

```java
public @interface AnnoDemo {
    String name() default "tomiaa";
    int age() default 20;
    float score() default 60.0f;
}
```

### 2ï¼‰æ³¨è§£çš„â€œå‚æ•°â€æ˜¯ä»€ä¹ˆ

æ³¨è§£é‡Œçœ‹èµ·æ¥åƒâ€œæ— å‚æ–¹æ³•â€çš„ä¸œè¥¿ï¼Œå…¶å®å°±æ˜¯æ³¨è§£çš„å‚æ•°ï¼ˆä¹Ÿå«å…ƒç´ ï¼‰ã€‚

è§„åˆ™è®°ä½ä¸‰æ¡å°±å¤Ÿç”¨ï¼š

- **è¿”å›å€¼ä¸èƒ½æ˜¯ `void`**
- **æ”¯æŒçš„ç±»å‹æœ‰é™**ï¼šåŸºæœ¬ç±»å‹ã€`String`ã€`Class`ã€æšä¸¾ã€æ³¨è§£ã€ä»¥åŠå®ƒä»¬çš„æ•°ç»„
- å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°å« `value`ï¼Œä½¿ç”¨æ—¶å¯ä»¥çœç•¥ `value=`

```java
public @interface Role {
    String value();
}

@Role("admin") // ç­‰ä»·äº @Role(value = "admin")
class User {}
```

### 3ï¼‰ä»€ä¹ˆæ—¶å€™â€œè¯»å¾—åˆ°â€è‡ªå®šä¹‰æ³¨è§£

è¿™å–å†³äº `@Retention`ï¼ˆç”Ÿå‘½å‘¨æœŸï¼‰ï¼š

- `SOURCE`ï¼šåªåœ¨æºç é‡Œï¼Œç¼–è¯‘åå°±æ²¡äº†ï¼ˆè¿è¡Œæ—¶è¯»ä¸åˆ°ï¼‰
- `CLASS`ï¼šåœ¨å­—èŠ‚ç é‡Œï¼Œä½† JVM è¿è¡Œæ—¶é»˜è®¤æ‹¿ä¸åˆ°ï¼ˆå¤§å¤šæ•°æƒ…å†µä¸‹è¯»ä¸åˆ°ï¼‰
- `RUNTIME`ï¼šè¿è¡Œæ—¶ä¿ç•™ï¼Œ**å¯ä»¥ç”¨åå°„è¯»åˆ°**ï¼ˆæ¡†æ¶æœ€å¸¸ç”¨ï¼‰

## å…ƒæ³¨è§£ï¼ˆä¿®é¥°â€œæ³¨è§£çš„æ³¨è§£â€ï¼‰

- å…ƒæ³¨è§£çš„ä½œç”¨æ˜¯ï¼šå‘Šè¯‰ç¼–è¯‘å™¨/æ¡†æ¶â€œä½ çš„æ³¨è§£èƒ½è´´åœ¨å“ªã€èƒ½ä¿å­˜åˆ°ä»€ä¹ˆæ—¶å€™ã€èƒ½å¦ç»§æ‰¿ã€èƒ½å¦é‡å¤â€ç­‰ã€‚
- ğŸ‘‰ @Target æ˜¯ Java å®˜æ–¹æä¾›çš„ã€Œå…ƒæ³¨è§£ã€
- ğŸ‘‰ å®šä¹‰åœ¨ java.lang.annotation åŒ…é‡Œ
- ğŸ‘‰ ç”¨æ¥é™åˆ¶â€œä½ çš„æ³¨è§£å¯ä»¥è´´åœ¨å“ªäº›åœ°æ–¹â€

### `@Target`ï¼šèƒ½è´´åœ¨å“ª

å¸¸è§å–å€¼ï¼š

| å€¼                        | è¯´æ˜                   |
| ------------------------- | ---------------------- |
| `ElementType.TYPE`        | ç±»/æ¥å£/æšä¸¾           |
| `ElementType.FIELD`       | æˆå‘˜å˜é‡               |
| `ElementType.METHOD`      | æ–¹æ³•                   |
| `ElementType.PARAMETER`   | æ–¹æ³•å‚æ•°               |
| `ElementType.CONSTRUCTOR` | æ„é€ æ–¹æ³•               |

```java
import java.lang.annotation.ElementType;
import java.lang.annotation.Target;

@Target(ElementType.METHOD) // â€œè¿™ä¸ªæ³¨è§£ï¼Œåªå…è®¸è´´åœ¨æ–¹æ³•ä¸Šâ€
public @interface TrackTime {}
```

### `@Retention`ï¼šä¿ç•™åˆ°ä»€ä¹ˆæ—¶å€™

```java
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;

@Retention(RetentionPolicy.RUNTIME)
public @interface TrackTime {}
```

### `@Documented`ï¼šæ˜¯å¦è¿›å…¥ç”Ÿæˆæ–‡æ¡£

```java
import java.lang.annotation.Documented;

@Documented
public @interface TrackTime {}
```

### `@Inherited`ï¼šå­ç±»æ˜¯å¦ç»§æ‰¿ï¼ˆåªå¯¹ç±»æœ‰æ•ˆï¼‰

```java
import java.lang.annotation.Inherited;

@Inherited
public @interface ApiModule {}
```

### `@Repeatable`ï¼šåŒä¸€ä½ç½®èƒ½å¦é‡å¤æ ‡æ³¨

```java
import java.lang.annotation.Repeatable;

@Repeatable(Tags.class)
public @interface Tag {
    String value();
}

public @interface Tags {
    Tag[] value();
}

@Tag("backend")
@Tag("java")
class Post {}
```

## è¿è¡Œæ—¶è¯»å–æ³¨è§£ï¼šä¸ºä»€ä¹ˆæ¡†æ¶ç¦»ä¸å¼€å®ƒ

å½“ä¸€ä¸ªæ³¨è§£æ˜¯ `RetentionPolicy.RUNTIME` æ—¶ï¼Œæ¡†æ¶å°±èƒ½é€šè¿‡åå°„è¯»å–å®ƒï¼š

```java
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;

@Retention(RetentionPolicy.RUNTIME)
@interface Role {
    String value();
}

@Role("admin")
class User {}

public class ReadAnnoDemo {
    public static void main(String[] args) {
        Role role = User.class.getAnnotation(Role.class);
        System.out.println(role.value()); // admin
    }
}
```

ä½ å¯ä»¥æŠŠè¿™ä¸ªè¿‡ç¨‹æƒ³è±¡æˆï¼šæ¡†æ¶åœ¨å¯åŠ¨æ—¶æ‰«æ classï¼Œç„¶åæ ¹æ®æ³¨è§£é‡Œå†™çš„â€œé…ç½®â€ï¼Œè‡ªåŠ¨æŠŠå®ƒæ³¨å†Œè¿›å®¹å™¨/è·¯ç”±è¡¨/æ ¡éªŒé“¾è·¯é‡Œã€‚

## æ€»ç»“

- æ³¨è§£ = **ç»™ç¼–è¯‘å™¨/æ¡†æ¶çœ‹çš„æ ‡ç­¾ï¼ˆå…ƒæ•°æ®ï¼‰**
- æƒ³è®©æ¡†æ¶è¿è¡Œæ—¶è¯»åˆ° â†’ è®°å¾— `@Retention(RUNTIME)`
- `@Target` å†³å®šèƒ½è´´åœ¨å“ªï¼›`@Repeatable` å†³å®šèƒ½ä¸èƒ½è´´å¤šä¸ªï¼›`@Inherited` å½±å“ç±»ç»§æ‰¿åœºæ™¯
- JDK å¸¸ç”¨ä¸‰ä¸ªï¼š`@Override`ï¼ˆé˜²å†™é”™ï¼‰ã€`@Deprecated`ï¼ˆæç¤ºæ›¿ä»£ï¼‰ã€`@SuppressWarnings`ï¼ˆæˆ‘çŸ¥é“æˆ‘åœ¨å¹²å•¥ï¼‰
